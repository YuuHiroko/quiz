// ==========================
// DATA: ALL 8 UNITS (Unit 1 & 2 have MCQs; fill in 3-8 in this format)
// ==========================
const unitsData = {
  "Nursing Education": [
    {
  unitName: "Unit 1: Introduction to Theoretical Foundations",
  questions: [
    {
      questionText: "The all-round development drawing out the best of a child was envisaged by:",
      options: [
        "Swami Vivekananda",
        "Aurobindo Ghosh",
        "Mahatma Gandhi",
        "Dr Radhakrishnan"
      ],
      correctAnswer: "Mahatma Gandhi"
    },
    {
      questionText: "Reconstruction is termed:",
      options: [
        "Critical thinking theory",
        "Assumption theory",
        "Inclusion theory",
        "Exclusion theory"
      ],
      correctAnswer: "Critical thinking theory"
    },
    {
      questionText: "Education is termed:",
      options: [
        "Fitness of good.",
        "Living a better life by caring good",
        "Lifelong process",
        "Process to achieve something"
      ],
      correctAnswer: "Lifelong process"
    },
    {
      questionText: "Arms of education are:",
      options: [
        "Social, volcano and cultural",
        "Normal, spiritual and intellectual",
        "To get an employment",
        "Both (a) and (d)"
      ],
      correctAnswer: "Both (a) and (d)"
    },
    {
      questionText: "Principles of education is except:",
      options: [
        "Self-determination",
        "Develop independent learning skills",
        "Develop leadership skills",
        "To guide people"
      ],
      correctAnswer: "To guide people"
    },
    {
      questionText: "Learning is except:",
      options: [
        "Self-directed",
        "Self-activity",
        "Not transferable",
        "Creative"
      ],
      correctAnswer: "Not transferable"
    },
    {
      questionText: "The most recognized learning theory in education is:",
      options: [
        "Bloom’s taxonomy",
        "Motivational theory",
        "Theory of avoidance",
        "None of these"
      ],
      correctAnswer: "Bloom’s taxonomy"
    },
    {
      questionText: "Affective domain of learning includes:",
      options: [
        "Attitude, values, interest and appreciation",
        "Attitude, moral, interest and appreciation",
        "Attitude, moral and appreciation",
        "Attitude, values and interest"
      ],
      correctAnswer: "Attitude, values, interest and appreciation"
    },
    {
      questionText: "Transformation learning process is:",
      options: [
        "Based on learning by doing",
        "Make sense of other life experiences",
        "Make sense and people’s own life experiences",
        "Based on cognitive values"
      ],
      correctAnswer: "Make sense and people’s own life experiences"
    },
    {
      questionText: "Education is dependent on:",
      options: [
        "Anthropology",
        "Sociology",
        "Philosophy",
        "Geography"
      ],
      correctAnswer: "Philosophy"
    },
    {
      questionText: "The objectives of lesson plan should be:",
      options: [
        "Learner oriented",
        "Teacher oriented",
        "Both (a) and (b)",
        "None of these"
      ],
      correctAnswer: "Learner oriented"
    },
    {
      questionText: "The learning domains of Bloom’s taxonomy are:",
      options: [
        "Cognitive and psychomotor",
        "Alternative and cognitive",
        "Cognitive, affective and psychomotor",
        "Psychomotor and effective"
      ],
      correctAnswer: "Cognitive, affective and psychomotor"
    },
    {
      questionText: "Central objective is also known as:",
      options: [
        "Specific objective",
        "Departmental objective",
        "Institution objective",
        "Main objective"
      ],
      correctAnswer: "Institution objective"
    },
    {
      questionText: "The maxims of learning is:",
      options: [
        "Known to unknown",
        "Concrete to abstract",
        "Sample to complex",
        "All of these"
      ],
      correctAnswer: "All of these"
    },
    {
      questionText: "The stages of learning are:",
      options: [
        "Cognitive, associate and disassociate",
        "Cognitive, autonomous and captive",
        "Cognitive, associative and autonomous",
        "Cognitive, associative and behavior"
      ],
      correctAnswer: "Cognitive, associative and autonomous"
    }
  ]
},
    {
  unitName: "Unit 2: Assessment and Planning",
  questions: [
    {
      questionText: "Factors influencing selection of clinical learning experience except:",
      options: [
        "Allowing students to practise and make decision",
        "Relationship with clinical staff",
        "Mentoring done by teaching and clinical staff",
        "Innovative and creative clinical environment"
      ],
      correctAnswer: "Allowing students to practise and make decision"
    },
    {
      questionText: "The learning outcomes in clinical setting should be focused on:",
      options: [
        "Students ability to focus on interpersonal/relationship",
        "Student ability to work without supervision",
        "Student knowledge to be focused",
        "Student behavior to be focused interms of application of theory in practice"
      ],
      correctAnswer: "Student behavior to be focused interms of application of theory in practice"
    },
    {
      questionText: "Nursing rounds are focused on:",
      options: [
        "Multidisciplinary approach",
        "Students-patient approach",
        "Patient-patient approach",
        "Patient-relative approach"
      ],
      correctAnswer: "Multidisciplinary approach"
    },
    {
      questionText: "The case study method of clinical teaching is:",
      options: [
        "Exhaustive, systematic and general investigation",
        "It focus on only individuals",
        "Extensive systematic and in depth investigation",
        "The multiple factor are ignored"
      ],
      correctAnswer: "It focus on only individuals"
    },
    {
      questionText: "Concept mapping is:",
      options: [
        "Used to encourage critical thniking",
        "Link key concepts for analysis of information",
        "Encourage students to improve judgment",
        "All of these"
      ],
      correctAnswer: "Encourage students to improve judgment"
    },
    {
      questionText: "Characteristics of curriculum are except:",
      options: [
        "Continuously evolving",
        "Logical sequence of subjects",
        "Educational quality",
        "Simple and short term effort"
      ],
      correctAnswer: "Simple and short term effort"
    },
    {
      questionText: "Curriculum development factors are:",
      options: [
        "Societal, economical factor",
        "Political and gender factor",
        "National priority, educational factor",
        "All of these"
      ],
      correctAnswer: "All of these"
    },
    {
      questionText: "Types of evaluation are:",
      options: [
        "Formative and summative",
        "Formative and automative",
        "Sumative and counter productive",
        "None of these"
      ],
      correctAnswer: "Formative and summative"
    },
    {
      questionText: "The steps of planning phase of curriculum devlopmental are",
      options: [
        "Identify problem",
        "For curriculum development team",
        "Both (a) and (b)",
        "None of these"
      ],
      correctAnswer: "Both (a) and (b)"
    },
    {
      questionText: "Highest percentage of learning takes place while doing (as per learning pyramid)",
      options: [
        "Reading",
        "Watching video",
        "Teaching others",
        "Discussion"
      ],
      correctAnswer: "Teaching others"
    },
    {
      questionText: "To be able to communicate well, a teacher will become an effective communicator if:",
      options: [
        "He uses instructional aids",
        "He helps students get meaning out of what he teaches",
        "He asks questions between teachings",
        "He helps students get correct answers to the questions on the topic"
      ],
      correctAnswer: "He helps students get meaning out of what he teaches"
    },
    {
      questionText: "A teacher is said to be good when she is capable of:",
      options: [
        "When she finishes the tasks on time",
        "Motivating students to learn",
        "Delivering a satisfactory outcome",
        "Assisting pupils in the preparation of good notes"
      ],
      correctAnswer: "Motivating students to learn"
    },
    {
      questionText: "Which of the following subject combinations would assist a teacher in developing effective pedagogical methods:",
      options: [
        "Sociology and philosophy",
        "Philosophy and psychology",
        "Psychology and sociology",
        "None of these"
      ],
      correctAnswer: "Psychology and sociology"
    },
    {
      questionText: "If a teacher wants to gain popularity among students, he or she should do the following:",
      options: [
        "Personally helps them in their studies",
        "Organizes tours routinely",
        "Whilst teaching, he dictates notes",
        "Maintains positive interpersonal relationships"
      ],
      correctAnswer: "Personally helps them in their studies"
    },
    {
      questionText: "Without the assistance of a teacher, a pupil attempts to solve an issue. The instructor should:",
      options: [
        "Tell him/her to seek assistance from his/her coworkers",
        "Not pay attention to him/her",
        "Chastises him/her for being an idiot",
        "Evaluate his or her own effort"
      ],
      correctAnswer: "Evaluate his or her own effort"
    },
    {
      questionText: "Which of the following statements about the Modern Annual Examination System is/are accurate?",
      options: [
        "It encourages cramming to get knowledge",
        "It does not motivate students to study on a regular basis",
        "It does not inspire students to come to class on a regular basis",
        "All of the above"
      ],
      correctAnswer: "All of the above"
    },
    {
      questionText: "Which of the following is a good indicator of teaching quality?",
      options: [
        "Keeping the harmony in the classroom for a period of time",
        "Students’ inquiries in the classroom should be of a certain standard",
        "Standard of answers replied by students in the classroom",
        "The percentage of pupils that pass"
      ],
      correctAnswer: "The percentage of pupils that pass"
    },
    {
      questionText: "The main goal of education is to:",
      options: [
        "Strengthen the mind",
        "Develop reasoning ability",
        "Both (a) and (b)",
        "Give information only"
      ],
      correctAnswer: "Both (a) and (b)"
    },
    {
      questionText: "New or the basic education is also known as :",
      options: [
        "Crucial education",
        "New Education policy",
        "Wardha education plan",
        "Drive for education to all"
      ],
      correctAnswer: "Wardha education plan"
    },
    {
      questionText: "Why do teachers need to study philosophy of education?",
      options: [
        "To understand theory philosophy of inheritance",
        "Being acquainted with abstract knowledge",
        "Defining the curriculum’s goals and objectives",
        "Obtaining concepts for controlling instructional behavior"
      ],
      correctAnswer: "To understand theory philosophy of inheritance"
    },
    {
      questionText: "Values of every human being are reflected in:",
      options: [
        "Realism",
        "Pragmatism",
        "Naturalism",
        "Idealism"
      ],
      correctAnswer: "Idealism"
    },
    {
      questionText: "Developing the universal human values means:",
      options: [
        "Indoctrination",
        "Adoption",
        "Imitation",
        "Manifestation"
      ],
      correctAnswer: "Manifestation"
    },
    {
      questionText: "Applying listening skills to a lecture which is being delivered in the class room:",
      options: [
        "Informative audition",
        "Assessed audition",
        "Added audition",
        "None of these"
      ],
      correctAnswer: "Informative audition"
    },
    {
      questionText: "What is the ideal situation in the classroom?",
      options: [
        "The lecturer prepares himself for the lecture before entering the classroom and gives his speech with complete confidence",
        "Students enter the classroom with their bags packed. Prepare and discuss the subject with one another in the presence of the lecturer",
        "Lecturer and the students discuss the subject",
        "While delivering the lecture, the lecturer uses audio-visual means"
      ],
      correctAnswer: "The lecturer prepares himself for the lecture before entering the classroom and gives his speech with complete confidence"
    },
    {
      questionText: "A teacher should be well-versed in which of the following in order to comprehend his students?",
      options: [
        "Child psychology",
        "A proclivity for gaining a better knowledge of children",
        "Students’ perspectives on the subject",
        "All of the above"
      ],
      correctAnswer: "All of the above"
    },
    {
      questionText: "The following is a description of the educational process in practice:",
      options: [
        "Very credible, authentic and regular",
        "Not credible",
        "Credible but not regular",
        "None of these"
      ],
      correctAnswer: "Very credible, authentic and regular"
    },
    {
      questionText: "Which teaching technique encourages students to make the most of their knowledge?",
      options: [
        "Problem Solution Method",
        "Laboratory Method",
        "Self-Study Method",
        "Team-Study Method"
      ],
      correctAnswer: "Laboratory Method"
    },
    {
      questionText: "The primary sources are books and documents:",
      options: [
        "Historical research data",
        "Participation data",
        "Medical research data",
        "Laboratory research data"
      ],
      correctAnswer: "Historical research data"
    },
    {
      questionText: "An open book exam method has which of the following significant characteristics?",
      options: [
        "Serious behavior of the student",
        "Increase attendance in the class-room",
        "Reduces the stress related to examination",
        "Compelling student from thinking"
      ],
      correctAnswer: "Compelling student from thinking"
    },
    {
      questionText: "Quality of a effective teacher is :",
      options: [
        "Control over the class",
        "Delivering of information in limited period",
        "Inspiring students to learn",
        "Amends the carefully assignments"
      ],
      correctAnswer: "Inspiring students to learn"
    }
  ]
},
    // Fill units 3–8 in exactly this same format.
    { unitName: "Unit 3: Implementation", questions: [ /* ... */ ] },
    { unitName: "Unit 4: Teaching in the Clinical Setting", questions: [ /* ... */ ] },
    { unitName: "Unit 5: Educational/Teaching Media", questions: [ /* ... */ ] },
    { unitName: "Unit 6: Assessment and Evaluation Methodologies", questions: [ /* ... */ ] },
    { unitName: "Unit 7: Guidance/Academic Advising Counseling and Discipline", questions: [ /* ... */ ] },
    { unitName: "Unit 8: Ethics and Evidence-Based Teaching in Nursing Education", questions: [ /* ... */ ] }
  ]
};

// ========== STATE (with unlock/complete logic persisted) ==========
const UNLOCK_KEY = "ne_mcq_units_unlocked";
const COMPLETE_KEY = "ne_mcq_units_completed";

// Initialize unlock state: only first unit unlocked by default.
function initUnitProgress() {
  let unlocked = JSON.parse(localStorage.getItem(UNLOCK_KEY));
  let completed = JSON.parse(localStorage.getItem(COMPLETE_KEY));
  if (!Array.isArray(unlocked) || unlocked.length !== 8) unlocked = [true, false, false, false, false, false, false, false];
  if (!Array.isArray(completed) || completed.length !== 8) completed = [false, false, false, false, false, false, false, false];
  return { unlocked, completed };
}

function saveUnitProgress(unlocked, completed) {
  localStorage.setItem(UNLOCK_KEY, JSON.stringify(unlocked));
  localStorage.setItem(COMPLETE_KEY, JSON.stringify(completed));
}

let { unlocked, completed } = initUnitProgress();
let currentUnitIdx = 0;
let currentQuestionIdx = 0;
let score = 0;
let answers = [];

// ========== UI LOGIC ==========
function showUnits() {
  const app = document.getElementById('app');
  app.innerHTML = '<h2>Units</h2><ul class="unit-list"></ul>';
  const list = app.querySelector('.unit-list');
  unitsData["Nursing Education"].forEach((unit, idx) => {
    const li = document.createElement('li');
    li.className = "unit";
    if (!unlocked[idx]) li.classList.add("locked");
    if (completed[idx]) li.classList.add("completed");
    li.textContent = unit.unitName;
    if (completed[idx]) {
      li.title = "Completed! All answers correct.";
    } else if (!unlocked[idx]) {
      li.title = "Unlock this unit by scoring 100% on the previous unit.";
    } else {
      li.title = "Start quiz for this unit";
    }
    li.tabIndex = unlocked[idx] ? 0 : -1;
    if (unlocked[idx]) {
      li.onclick = () => startQuiz(idx);
    }
    list.appendChild(li);
  });

  // Show banner if a new unit is unlocked
  if (unlocked.some((u, idx) => u && !completed[idx] && idx > 0 && !unlocked[idx-1])) {
    app.innerHTML += `
      <div style="margin-top:20px; background:linear-gradient(90deg,#cdf9e7,#f1fff9 80%);
                  color:#167255;padding:15px 12px;border-radius:8px;font-weight:600;
                  border:1.5px solid #b5efdf;font-size:1.05rem;text-align:center">
        🎉 Congrats! You’ve unlocked a new unit. Keep going for perfection!
      </div>
    `;
  }
}

function startQuiz(unitIdx) {
  currentUnitIdx = unitIdx;
  currentQuestionIdx = 0;
  score = 0;
  answers = [];
  showQuestion();
}

function showQuestion() {
  const unit = unitsData["Nursing Education"][currentUnitIdx];
  const question = unit.questions[currentQuestionIdx];
  const app = document.getElementById('app');
  app.innerHTML = `
    <h2>${unit.unitName}</h2>
    <div class="progress">Q${currentQuestionIdx + 1} / ${unit.questions.length}</div>
    <div class="question">${question.questionText}</div>
    <div class="options" id="options"></div>
    <button class="back-btn" onclick="showUnits()">⬅ Back to Units</button>
  `;
  question.options.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.className = "option-btn";
    btn.onclick = () => submitAnswer(opt);
    document.getElementById('options').appendChild(btn);
  });
}

function submitAnswer(selected) {
  const unit = unitsData["Nursing Education"][currentUnitIdx];
  const question = unit.questions[currentQuestionIdx];
  answers.push({
    question: question.questionText,
    options: question.options,
    selected,
    correct: question.correctAnswer
  });
  if (selected === question.correctAnswer) score++;
  currentQuestionIdx++;
  if (currentQuestionIdx < unit.questions.length) {
    showQuestion();
  } else {
    showResult();
  }
}

function showResult() {
  const unit = unitsData["Nursing Education"][currentUnitIdx];
  const app = document.getElementById('app');
  const isPerfect = score === unit.questions.length;
  // Update completion state
  completed[currentUnitIdx] = isPerfect;
  if (isPerfect && currentUnitIdx < 7 && !unlocked[currentUnitIdx + 1]) {
    unlocked[currentUnitIdx + 1] = true;
  }
  saveUnitProgress(unlocked, completed);

  let comment = isPerfect ? "Perfect! This unit is complete and the next is unlocked." :
                score / unit.questions.length > 0.8 ? "Excellent! Try again for a perfect score and unlock the next unit." :
                score / unit.questions.length > 0.6 ? "Good effort. Try to master all questions for progress." :
                "Keep practicing! Review the correct answers below.";

  app.innerHTML = `
    <div class="score-card">
      <div class="score">Your Score: ${score} / ${unit.questions.length}</div>
      <div class="score-comment">${comment}</div>
      ${isPerfect ? `<div style="color:#19a659;margin-top:6px;font-weight:700;font-size:1.14em;">🎉 Unit Unlocked!</div>` : ""}
    </div>
    <div class="result-list">
      ${answers.map((a, i) => `
        <div class="result-question">
          <span class="q-title">Q${i + 1}. ${a.question}</span>
          <div>
            Your answer: 
              <span class="${a.selected === a.correct ? 'correct' : 'wrong'}">
                ${a.selected}
                ${a.selected === a.correct 
                  ? '<span class="result-correct-icon">✔️</span>'
                  : '<span class="result-wrong-icon">❌</span>'
                }
              </span>
          </div>
          <div>
            Correct answer: <span class="correct">${a.correct}</span>
          </div>
        </div>
      `).join('')}
    </div>
    <button class="retry-btn" onclick="startQuiz(${currentUnitIdx})">Try This Unit Again</button>
    <button class="back-btn" onclick="showUnits()">⬅ Back to Units</button>
  `;
}

// ========== BOOTSTRAP ==========
window.showUnits = showUnits;
window.startQuiz = startQuiz;
document.addEventListener("DOMContentLoaded", showUnits);
